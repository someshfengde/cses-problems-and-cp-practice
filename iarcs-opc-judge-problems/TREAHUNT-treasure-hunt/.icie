{"task_url":"https://www.codechef.com/IARCSJUD/problems/TREAHUNT","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Treasure Hunt</h1>\n<p>A well-known bandit who used to haunt the forests around Siruseri was eliminated by the policemen a few months ago. There are several stories about a valuable treasure that he is alleged to have buried somewhere in the forest.</p>\n<p>The deceased bandit had several hideouts and the police found a lot of things in these hideouts --- a number of guns, ammunition, knives, ... Interestingly, in every hideout there was a strange looking machine. This machine looked a bit like the weighing machine that is found in Indian railway stations where you insert a coin and get a card with your weight printed on it. The police had no idea what these machines were meant for and since they were heavy and in the middle of the forest they just left them there.</p>\n<p>Only one man knew that the clue to the buried treasure was in these innocuous looking machines and that was Muttal. Muttal used to be part of the dacoit's band of robbers but was thrown out for being too dumb.</p>\n<p>Here is how the treasure was to be found. One had to insert a 1 rupee coin into one of these machines. This machine would then put out a token and a card on which was printed the name of the machine to be visited next. The token was then to be inserted into the machine whose name was printed on the card. The new machine would, in turn, produce another token and another card with a new destination printed on it, and so on.</p>\n<p>If you started with by putting a 1 rupee coin in the correct machine place and followed the sequence of machines indicated by the cards, inserting each token produced by one machine into the next one, eventually one of these machines would put out a map to the treasure. Unfortunately, though, Muttal did not know which machine one should begin with.</p>\n<p>Unknown to Muttal, the bandit had played one last joke on the world. Knowing his end was near, he had reprogrammed these machines. There was no longer any map. All that you got for inserting a token in any machine was another token and a card leading you to the next machine. So poor Muttal is going to spend the rest of his life inserting tokens into machines and walking from one machine to another.</p>\n<p>You are given $M$ machines that generate and respond to $T$ different kinds of tokens. We regard the 1 rupee coin also as one of the $T$ types of tokens. For each machine $m$ and each token $t$ you are told what happens when $t$ is inserted into $m$: that is, which token is produced by $m$ and what the next destination printed on the card is.</p>\n<p>Your task is the following. Given the identity of the machine where Muttal starts his search and an integer $N$, identify the $N$-th machine that Muttal will visit. Muttal always begins his search by inserting a 1 rupee coin into the first machine.</p>\n<p>For example suppose there are three machines and two kinds of tokens and the description of the machines is as follows:</p>\n<table >\n  <tr>\n    <th>Machine</th>\n    <th>Input Token</th>\n    <th>Next Token</th>\n    <th>Next Machine</th>\n  </tr>\n  <tr>\n    <td>M1</td>\n    <td>T1</td>\n    <td>T2</td>\n    <td>M2</td>\n  </tr>\n    <tr>\n    <td>M1</td>\n    <td>T2</td>\n    <td>T1</td>\n    <td>M2</td>\n  </tr>\n  <tr>\n    <td>M2</td>\n    <td>T1</td>\n    <td>T1</td>\n    <td>M3</td>\n  </tr>\n  <tr>\n    <td>M2</td>\n    <td>T2</td>\n    <td>T2</td>\n    <td>M3</td>\n  </tr>\n  <tr>\n    <td>M3</td>\n    <td>T1</td>\n    <td>T1</td>\n    <td>M1</td>\n  </tr>\n  <tr>\n    <td>M3</td>\n    <td>T2</td>\n    <td>T2</td>\n    <td>M1</td>\n  </tr>\n</table> \n<p>We take $T_1$ to represent the one rupee coin. If Muttal starts at machine $M_1$ then the sequence of machines he visits is $M_1, M_2, M_3, M_1, M_2, M_3, \\ldots$. Thus, the fourth machine he visits is $M_1$, the fifth machine he visits is $M_2$ and so on.</p>\n<h3>Input format</h3>\n<ul>\n<li>The first line of the input consists of four integers $M$, $T$, $S$ and $N$, where $M$ is the number of machines, $T$ is the number of tokens, $S$ is the machine where Muttal starts his wild goose chase and you need to compute the $N$-th machine he visits. </li>\n<li>We assume that the machines are numbered $1, 2, \\ldots, M$ and the tokens are numbered $1, 2, \\ldots, T$ and that the one rupee coin is the same as token 1. </li>\n<li>This is followed by $M \\times T$ lines of input (lines $2, 3, \\ldots, M \\times T+1$) each containing two integers. The first $T$ of these give information about what comes out of machine 1 if different tokens are inserted into it, the next $T$ describes the same for machine 2 and soon. In other words, line $m \\times M+i+1$ ($0 \\leq m &lt; M, 1 \\leq i \\leq T$) contains two integers $t(m,i)$ and $c(m,i)$ where $t(m,i)$ is the token put out by machine $m$ when token $i$ is inserted into it and $c(m,i)$ is the machine name printed in the card put out when token $i$ is inserted into machine $m$.</li>\n</ul>\n<h3>Output format</h3>\n<ul>\n<li>A single integer $A$ indicating the $N$-th machine that Muttal visits.</li>\n</ul>\n<h3>Constraints</h3>\n<ul>\n<li>$1 \\leq M \\leq 200$</li>\n<li>$1 \\leq T \\leq 20$</li>\n<li>$1 \\leq N \\leq 1000000000$</li>\n</ul>\n<h3>Subtasks</h3>\n<ul>\n<li>Subtask 1: 50% - $1 \\leq N \\leq 1000000$ </li>\n<li>Subtask 2: 50% - Original constraints</li>\n</ul>\n<h3>Sample Input</h3>\n<pre><code>3 2 1 4\n2 2 \n1 2 \n1 3 \n2 3 \n1 1 \n2 1 \n</code></pre>\n<h3>Sample Output</h3>\n<pre><code>1\n</code></pre>\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.</div></aside>\n\t<body>\n</html>"}}}