{"task_url":"https://www.codechef.com/IARCSJUD/problems/NUMTRIPL","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Number Triples</h1>\n<p>In this problem you will be given a sequence of triples of positive integers. For example:</p>\n<p>$ $</p>\n<pre><code>   1  2   5\n   5  2   6\n   1  3   8\n   8  1  11\n   1  1   6\n  10  1   6\n  11  3   6\n  10  4   8\n  10  1  11\n</code></pre>\n<p>$ $</p>\n<p>Given a pair of numbers A and B, a chain connecting A and B is a sequence of triples</p>\n<p>$$A_0 W_0 A_1, \\quad A_1 W_1 A_2,  \\quad A_2 W_2 A_3,  \\quad ... A_{k-2} W_{k-2} A_{k-1}, \\quad  A_{k-1} W_{k-1} A_k$$</p>\n<p>such that</p>\n<ul>\n<li>$A_0 = A$</li>\n<li>$A_k = B$</li>\n</ul>\n<p>For each $i$, $0 \\leq i &lt; k$, either the triple $A_i$ $W_i$ $A_{i+1}$ or the triple $A_{i+1}$ $W_i$ $A_i$ is in the given set of triples.</p>\n<p>The value of such a chain is the sum of the $W_i$s in the chain. For example, here is a chain connecting $1$ and $11$ using the triples listed above:</p>\n<p>$$1 ; 1 ; 6, \\quad 6 ; 3 ; 11$$</p>\n<p>The value of this chain is $1+3 = 4$.</p>\n<p>Here is another chain connecting $1$ and $11$.</p>\n<p>$$1 ; 1 ; 6, \\quad 6 ; 1 ; 10, \\quad 10 ; 1 ; 11$$</p>\n<p>The value of this chain is $1+1+1 = 3$. You can verify that among all chains connecting $1$ and $11$ this is the one with least value.</p>\n<p>Sometimes there may be no chains connecting the given pair of numbers. For example, there is no chain connecting $1$ and $2$.</p>\n<p>You will be given a sequence of triples and a pair of numbers. Your task is to find the value of the least value chain connecting the two numbers.</p>\n<h3>Input:</h3>\n<ul>\n<li>The first line of the input has three numbers $M$, $A$ and $B$, where $M$ is the number of triples, and your task is to find the value of the least value chain connecting $A$ and $B$.</li>\n<li>The next $M$ lines (lines $2,3, \\ldots,M+1$) describe the triples. Line $i+1$ contains the three positive integers $X_i$, $Y_i$ and $Z_i$ that make up the $i^{th}$ triple. </li>\n</ul>\n<h3>Output:</h3>\n<ul>\n<li>If there is at least one chain connecting $A$ and $B$ the first line of the output must consist of a single word <code>YES</code>. </li>\n<li>In that case the second line must contain a single integer value indicating the value of the least valued chain connecting $A$ and $B$. </li>\n<li>If there are no chains connecting $A$ and $B$ the output should contain a single line with the word <code>NO</code> on it.</li>\n</ul>\n<h3>Constraints:</h3>\n<ul>\n<li>$1 \\leq M \\leq 4000000$</li>\n<li>$1 \\leq A, B \\leq 2000$</li>\n<li>$1 \\leq X_i, Y_i, Z_i \\leq 2000$</li>\n</ul>\n<h3>Sample Input 1:</h3>\n<pre><code>9 1 11\n1 2 5\n5 2 6\n1 3 8\n8 1 11\n1 1 6\n10 1 6\n11 3 6\n10 4 8\n10 1 11\n</code></pre>\n<h3>Sample Output 1:</h3>\n<pre><code>YES\n3\n</code></pre>\n<h3>Sample Input 2:</h3>\n<pre><code>9 1 2\n1 2 5\n5 2 6\n1 3 8\n8 1 11\n1 1 6\n10 1 6\n11 3 6\n10 4 8\n10 1 11\n</code></pre>\n<h3>Sample Output 2:</h3>\n<pre><code>NO\n</code></pre>\n<aside style='background: #f8f8f8;padding: 10px 15px;'><div>All submissions for this problem are available.</div></aside>\n\t<body>\n</html>"}}}